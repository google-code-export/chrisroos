<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>

  <head>
    <meta name="microid" content="ff511e16d7108be450fccd6f4611cf8d1d5416d1" >
    <meta http-equiv="content-type" content="text/html; charset=utf-8" >
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/DeferredUntilInspirationHits" >
    <link rel="stylesheet" href="/stylesheets/yui-reset-fonts-grids.css" type="text/css" media="all">
    <link rel="stylesheet" href="/stylesheets/blog.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" media="screen" charset="utf-8">
    <link rel="openid.server" href="http://www.myopenid.com/server">
    <link rel="openid.delegate" href="http://chrisroos.myopenid.com/">
    <title>Posts tagged internet - deferred until inspiration hits</title>
  </head>
  
  <body>
    
    <div id="doc3" class="yui-t4">
      <div id="hd">
        <h1><a class="blogTitle" href="/">deferred until inspiration hits</a></h1>
      </div>
      <div id="bd">
        <div id="yui-main">
          <div class="yui-b">
            <div class="yui-g">

              
                <h2>
                  <a href="/articles/2007/12/14/cross-browser-well-ie-6-firefox-2-and-safari-3-bookmarklet-script">Cross browser (well, IE 6, Firefox 2 and Safari 3) bookmarklet script</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Fri, 14 Dec 2007 21:27:00">
                    Fri, 14 Dec 2007 21:27:00
                  </span>
                </p>

                <p>I <a href="http://blog.seagul.co.uk/articles/2007/12/14/bookmarklet-favelet-limits-in-internet-explorer-6-and-7">mentioned</a> that I&#8217;d been playing with bookmarklets in Internet Explorer 6 (among other, proper, browsers).</p>


	<p>I thought it might be useful to paste the script that bootstraps the bookmarklet.  The concept is that we use the bookmarklet javascript to insert a script tag into the page that links to the full javascript file containing the function(s) that we wish to execute.  I know this has been documented elsewhere and I&#8217;ve probably missed some important stuff out but it may prove useful to someone.</p>


	<h3>The commented, un-compressed, version</h3>


<div class="typocode"><pre><code class="typocode_javascript">if (typeof(rvmBM) == 'undefined') { // Best to name rvmBM to something unlikely to clash with pre-defined variables
  var s = document.createElement('script'); // Use of s versus script saves some precious space
  s.type = 'text/javascript';
  s.src = 'http://example.com/my-external-bookmarklet.js'; // The location of your bookmarklet javascript that does all the work
  void(rvmBM = true); // Prevent the bookmarklet javascript from being loaded multiple times by setting this flag
  void(document.body.appendChild(s)); // Place the script tag in the body of the document
  // If we don't use void() above then we end up writing either 'true' or some junk to the screen in Internet Explorer (only)
};
function addRvm() { // A wrapper function around the actual function we want to call
  if (typeof(addReevooMark) == 'function') { // We want to make sure our bookmarklet function is defined (there's some delay in it becoming available in Firefox.  It's defined immediately in Internet Explorer.)
    addReevooMark();
  } else {
    void(setTimeout(addRvm, 100)); // If our function isn't ready yet we'll just hang on 1/10th of a second and try again
  };
};
addRvm(); // Ask our wrapper function to call the actual bookmarklet function</code></pre></div>

	<h3>The compressed version</h3>


<div class="typocode"><pre><code class="typocode_javascript">javascript:if(typeof(rvmBM)=='undefined'){var s=document.createElement('script');s.type='text/javascript';s.src='http://example.com/my-external-bookmarklet.js';void(rvmBM=true);void(document.body.appendChild(s));};function addRvm(){if(typeof(addReevooMark)=='function'){addReevooMark();}else{void(setTimeout(addRvm,100));};};addRvm();</code></pre></div>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/bookmarklet" rel="tag">bookmarklet</a>, 
                    
                      <a href="/articles/tag/browser" rel="tag">browser</a>, 
                    
                      <a href="/articles/tag/explorer" rel="tag">explorer</a>, 
                    
                      <a href="/articles/tag/firefox" rel="tag">firefox</a>, 
                    
                      <a href="/articles/tag/internet" rel="tag">internet</a>, 
                    
                      <a href="/articles/tag/internet-explorer" rel="tag">internet-explorer</a>, 
                    
                      <a href="/articles/tag/javascript" rel="tag">javascript</a>, 
                    
                      <a href="/articles/tag/safari" rel="tag">safari</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/12/14/bookmarklet-favelet-limits-in-internet-explorer-6-and-7">Bookmarklet (Favelet) limits in Internet Explorer 6 (and 7?)</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Fri, 14 Dec 2007 08:46:00">
                    Fri, 14 Dec 2007 08:46:00
                  </span>
                </p>

                <p>I wasted quite a bit of time over the last couple of days trying to get a <a href="http://en.wikipedia.org/wiki/Bookmarklet">bookmarklet</a> (or favelet) working in Internet Explorer 6.  It worked perfectly in Firefox and Safari but wasn&#8217;t doing anything at all in IE.  Through lots of trial and error, I came to the conclusion that it was because of the length of the bookmarklet: it seems that Microsoft <a href="http://www.squarefree.com/2005/01/12/internet-explorer-drops-support-for-bookmarklets/">reduced the maximum length of a bookmarklet in <span class="caps">IE 6</span></a></p>


	<p>Although my original bookmarklet wasn&#8217;t all that long, I had it spread over multiple lines for readability.  The fix in my case was to remove all the spaces and place the bookmarklet on one line.</p>


	<p>I started to think that it might be nice to have a bookmarklet <a href="http://www.rubyonrails.com">rails</a> helper.  The bookmarklet helper would allow you to format your javascript for readability but shorten it all in the resulting html (it could even warn if the bookmarklet is too long for IE).  I couldn&#8217;t find anything similar, and I probably won&#8217;t get around to doing it myself, but I did decide to investigate the limit in IE (which could form the basis of such a helper).</p>


	<p>I used the html page below to test the limits of Internet Explorer.  This is the longest bookmarklet that I could get to work: one more character (a 2 on the end of those numbers, for example) and the bookmarklet won&#8217;t work (it still works if you click the link in the page &#8211; it only fails when used as an actual bookmarklet).</p>


<div class="typocode"><pre><code class="typocode_default">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot;&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;a href=&quot;javascript:
      var msg = 'hello world, this is my message.  i\'m trying to see how long i can be until internet explorer blows up in my face.';
      var msg = msg + '\n';
      var msg = msg + 'this is the second line of my long message';
      var msg = msg + '\n';
      var msg = msg + '12345679012345678901';
      alert(msg);&quot;&gt;bookmarklet&lt;/a&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre></div>

	<p>I noticed that, once added to Internet Explorer, the bookmarklet appeared to be <a href="http://www.blooberry.com/indexdot/html/topics/urlencoding.htm"><span class="caps">URL</span> encoded</a> (my assumption was based on the conversion of spaces to %20.)</p>


	<p><a href="http://www.flickr.com/photos/chrisjroos/2109757023/"><img src="http://farm3.static.flickr.com/2321/2109757023_0f69015c44.jpg" alt="" /></a></p>


	<p>I tried to replicate this encoded string in <a href="http://www.ruby-lang.org">ruby</a> but failed:  A simple <span class="caps">URI</span>.escape in ruby was escaping too much.  Inspecting the bookmarklet again seemed to suggest that the only encoding performed is to remove newlines and convert spaces to %20.  Replicating this in irb gave me the same string that Internet Explorer had in its favourites.</p>


<div class="typocode"><pre><code class="typocode_ruby"><span class="ident">irb</span><span class="punct">)</span> <span class="ident">str</span> <span class="punct">=</span> <span class="punct">&quot;</span><span class="string">javascript:
  var msg = 'hello world, this is my message.  i<span class="escape">\'</span>m trying to see how long i can be until internet explorer blows up in my face.';
  var msg = msg + '<span class="escape">\n</span>';
  var msg = msg + 'this is the second line of my long message';
  var msg = msg + '<span class="escape">\n</span>';
  var msg = msg + '12345679012345678901';
  alert(msg);</span><span class="punct">&quot;</span>
<span class="ident">irb</span><span class="punct">)</span> <span class="ident">p</span> <span class="ident">str</span><span class="punct">.</span><span class="ident">gsub</span><span class="punct">(&quot;</span><span class="string">'<span class="escape">\n</span>'</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">'--NEW-LINE--'</span><span class="punct">&quot;).</span><span class="ident">gsub</span><span class="punct">(&quot;</span><span class="string"><span class="escape">\n</span></span><span class="punct">&quot;,</span> <span class="punct">'</span><span class="string"></span><span class="punct">').</span><span class="ident">gsub</span><span class="punct">(&quot;</span><span class="string">'--NEW-LINE--'</span><span class="punct">&quot;,</span> <span class="punct">&quot;</span><span class="string">'<span class="escape">\n</span>'</span><span class="punct">&quot;).</span><span class="ident">gsub</span><span class="punct">('</span><span class="string"> </span><span class="punct">',</span> <span class="punct">&quot;</span><span class="string">%20</span><span class="punct">&quot;).</span><span class="ident">length</span>
<span class="punct">=&gt;</span> <span class="number">505</span></code></pre></div>

	<p>Everything I&#8217;d read about these bookmarklets in Internet Explorer suggested that the limit was 508 characters: the length of the bookmarklet above (once encoded) is only 505 characters.  Adding one more character makes it fail as a bookmarklet.  Hmm, maybe I&#8217;m doing something dumb?</p>


	<p>I&#8217;ve cheated a bit in the &#8216;encoding&#8217; above.  IE removes all newlines (I wonder if this happens in the <span class="caps">DOM</span> or just when you add it as a favourite?) so that the bookmarklet appears on one line.  I needed to do the same but also needed those newlines in the msg to remain (hence the <span class="caps">NEW</span>-LINE replacement stuff).  This is a very naive imlpementation: if you have &#8217;\n\n&#8217;, for example, then it breaks.  The &#8216;encoding&#8217; would need to be a little more intelligent in an actual helper (but only if you wanted to report on the size of the bookmarklet).</p>


	<p>I couldn&#8217;t find any reference to source of this 508 character limit in Internet Explorer: all the blog articles just state it as fact.  So, maybe it&#8217;s not 508.  Maybe it&#8217;s actually 505&#8230;</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/bookmarklet" rel="tag">bookmarklet</a>, 
                    
                      <a href="/articles/tag/browser" rel="tag">browser</a>, 
                    
                      <a href="/articles/tag/explorer" rel="tag">explorer</a>, 
                    
                      <a href="/articles/tag/internet" rel="tag">internet</a>, 
                    
                      <a href="/articles/tag/internet-explorer" rel="tag">internet-explorer</a>, 
                    
                      <a href="/articles/tag/javascript" rel="tag">javascript</a>, 
                    
                      <a href="/articles/tag/ruby" rel="tag">ruby</a>, 
                    
                      <a href="/articles/tag/url" rel="tag">url</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/10/15/more-hsbc-shenanigans">More Hsbc Shenanigans</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Mon, 15 Oct 2007 20:13:00">
                    Mon, 15 Oct 2007 20:13:00
                  </span>
                </p>

                <p>This will be of interest to very few (if any) people &#8211; I&#8217;d suggest you just move on to something more interesting.</p>


	<p>Yesterday, I contacted Hsbc using the Internet Banking feedback form that was outside of the Internet Banking site itself.</p>


<blockquote>
I believe that the Ofx export of transactions has been broken since your internet banking &#8216;upgrade&#8217;.  I&#8217;ve tried many times to contact you using My Messages and also over the phone &#8211; the people I seem to be dealing with are unable or unwilling to help.

	<p>It&#8217;s a very minor problem &#8211; my account is overdrawn yet the balance is shown as positive in the Ofx export.</p>


	<p>I&#8217;ve posted about the issue on my blog<sup><a href="#fn1">1</a></sup>, in the hope that someone might provide me some contact details of someone that can actually help.  Unfortunately that didn&#8217;t get my anywhere.</p>


	<p>I look forward to hearing from you.</p>


	<p>Cheers,</p>


	<p>Chris</p>


[1] http://blog.seagul.co.uk/articles/2007/10/05/trying-to-speak-to-someone-in-development-at-hsbc-can-anyone-help
</blockquote>

	<p>I was hoping to get through to a human.  Unfortunately I just got the same copy and paste bot that I get from within the Internet banking site.</p>


<blockquote>
Dear Mr Roos

	<p>Our Reference: 508-5629320-15102007-RR</p>


	<p>Thank you for using the feedback facility for our Internet Banking service.</p>


	<p>This is with regard to your recent e-mail concerning problems related to the download of transactions. From our experience to date, we have found that similar queries have been most effectively dealt with over the telephone rather than an exchange of a series of e-mails.</p>


	<p>On occasions it can be of benefit to be online whilst talking to us. You may wish to call from a separate line to your Internet connection.</p>


	<p>If you require further assistance, please call us on 0845 600 2290 (within UK) or +44 1226261226 (outside UK).  Minicom support is available on 0845 7125563.  The Internet Banking Helpdesk is open from Monday to Sunday 8.00am to 10.00pm (UK times).</p>


	<p>Kind Regards</p>


Rajan
Technical Support Representative
<span class="caps">HSBC</span> Internet Banking Technical Support
</blockquote>

	<p>Tonight, I&#8217;ve emailed their complaints email address.</p>


<blockquote>
Hi,

	<p>I&#8217;ll apologise in advance for potentially mis-using your complaints email address.</p>


	<p>I&#8217;ve got a problem with downloading my transactions in Ofx format from the Internet banking site.  I&#8217;ve written up my experience so far<sup><a href="#fn1">1</a></sup>.  As a web developer with experience of the Ofx format I&#8217;m fairly sure that you&#8217;ve got a bug in your Internet banking site.  I&#8217;ve been trying for over a month to speak to someone in your support department to no avail.</p>


	<p>All I want is for you (or someone that is able to do more than hit copy, paste, send) to read the post below and pass this information on to your development team &#8211; they will be able to help.</p>


	<p>Be assured that I&#8217;m really just trying to help you guys.  If you need anything else from me then just give me a shout.</p>


	<p>Cheers,</p>


	<p>Chris</p>


[1] http://blog.seagul.co.uk/articles/2007/10/05/trying-to-speak-to-someone-in-development-at-hsbc-can-anyone-help
</blockquote>

	<p>I&#8217;m getting slightly concerned that I might be wrong now &#8211; then I&#8217;d look real stoopid.  As it is I just look a bit sad.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/banking" rel="tag">banking</a>, 
                    
                      <a href="/articles/tag/hsbc" rel="tag">hsbc</a>, 
                    
                      <a href="/articles/tag/internet" rel="tag">internet</a>, 
                    
                      <a href="/articles/tag/ofx" rel="tag">ofx</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/10/05/trying-to-speak-to-someone-in-development-at-hsbc-can-anyone-help">Trying to speak to someone in development at Hsbc - can anyone help?</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Fri, 05 Oct 2007 08:43:00">
                    Fri, 05 Oct 2007 08:43:00
                  </span>
                </p>

                <p>I&#8217;m almost 100% certain that there&#8217;s a <a href="http://twitter.com/chrisroos/statuses/247143372">bug</a> in the Hsbc Internet Banking site.</p>


	<p>My account is overdrawn yet the balance shows as positive when I download my transactions in either &#8216;Money 98 onwards (ofx)&#8217; or &#8216;Quicken 2002 (ofx)&#8217;.  I believe that section 3.2.9.2 of the <a href="http://www.ofx.net">Ofx</a> 2.1.1 spec explains that these balances should be shown as negative.</p>


	<p>I&#8217;ve tried to <a href="http://www.flickr.com/search/?w=31365693@N00&#38;q=hsbc+AND+ofx&#38;m=tags">email</a> and I&#8217;ve <a href="http://twitter.com/chrisroos/statuses/279942352">tried</a> <a href="http://twitter.com/chrisroos/statuses/279956472">to</a> <a href="http://twitter.com/chrisroos/statuses/313632312">call</a> <a href="http://twitter.com/chrisroos/statuses/313656682">hsbc</a>.  Both to no avail.</p>


	<p>Does anyone know anyone that works at Hsbc and might be able to get a message to someone in development?  If not, what&#8217;s the etiquette on facebook groups?  I notice that there a few hsbc groups &#8211; can I just post messages to them asking for help?</p>


	<p>I&#8217;ve gotten so used to dealing with <a href="http://www.wesabe.com">real</a> companies that I&#8217;d forgotten how the old world works.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/banking" rel="tag">banking</a>, 
                    
                      <a href="/articles/tag/bug" rel="tag">bug</a>, 
                    
                      <a href="/articles/tag/crap" rel="tag">crap</a>, 
                    
                      <a href="/articles/tag/development" rel="tag">development</a>, 
                    
                      <a href="/articles/tag/hsbc" rel="tag">hsbc</a>, 
                    
                      <a href="/articles/tag/internet" rel="tag">internet</a>, 
                    
                      <a href="/articles/tag/ofx" rel="tag">ofx</a>, 
                    
                      <a href="/articles/tag/wesabe" rel="tag">wesabe</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/06/23/this-makes-me-happy">This makes me happy</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Sat, 23 Jun 2007 17:34:00">
                    Sat, 23 Jun 2007 17:34:00
                  </span>
                </p>

                <p>A <a href="http://birchington.blogspot.com/">local blogger</a> forwards a <a href="http://birchington.blogspot.com/2007/06/unusual-request.html">request</a> he&#8217;s received from a visiting pilot for photos to be taken of him practising at our <a href="http://en.wikipedia.org/wiki/Kent_International_Airport">local airstrip</a>.  I duly <a href="http://www.flickr.com/photos/chrisjroos/sets/72157600450060497/">obliged</a> (not hard as I live under the flight path) as has <a href="http://www.flickr.com/photos/doverpast/sets/72157600449864913/">one other</a> so far.  The Internet is great isn&#8217;t it.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/airlines" rel="tag">airlines</a>, 
                    
                      <a href="/articles/tag/blog" rel="tag">blog</a>, 
                    
                      <a href="/articles/tag/flickr" rel="tag">flickr</a>, 
                    
                      <a href="/articles/tag/internet" rel="tag">internet</a>, 
                    
                      <a href="/articles/tag/kia" rel="tag">kia</a>, 
                    
                      <a href="/articles/tag/manston" rel="tag">manston</a>, 
                    
                      <a href="/articles/tag/oasis" rel="tag">oasis</a>, 
                    
                      <a href="/articles/tag/oasis-airlines" rel="tag">oasis-airlines</a>, 
                    
                      <a href="/articles/tag/photo" rel="tag">photo</a>, 
                    
                      <a href="/articles/tag/plane" rel="tag">plane</a>, 
                    
                      <a href="/articles/tag/thanet" rel="tag">thanet</a>, 
                    
                  </p>
                
              

            </div>
          </div>
        </div>
        <div class="yui-b">
          <img src="/images/me.jpg" width="170px" height="111px" alt="Me">
          
          <ul class="navigation">
            <li>
              <a href="/contents">contents</a>
            </li>
            <li>
              <a href="http://flickr.com/photos/chrisjroos">flickr</a>
            </li>
          </ul>
          
          <div id="twitter_div">
            <h3><a href="http://twitter.com/chrisroos">twitter</a></h3>
            <ul id="twitter_update_list"></ul>
          </div>
          
          <div id="deliciousContainer">
            <h3><a href="http://del.icio.us/chrisjroos">del.icio.us</a></h3>
          </div>
        </div>
      </div>
    </div>
    <div id="ft">
      <!-- Footer -->
    </div>
    
    <script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script>
    <script type="text/javascript" src="http://twitter.com/statuses/user_timeline/chrisroos.json?callback=twitterCallback2&amp;count=5"></script>
    
    <script type="text/javascript" src="http://del.icio.us/feeds/json/chrisjroos?count=5"></script>
    <script type="text/javascript" src="/javascripts/delicious.js"></script>
  
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      var pageTracker = _gat._getTracker("UA-160238-1");
      pageTracker._initData();
      pageTracker._trackPageview();
    </script>
  </body>

</html>
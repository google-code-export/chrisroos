<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>

  <head>
    <meta name="microid" content="ff511e16d7108be450fccd6f4611cf8d1d5416d1" >
    <meta http-equiv="content-type" content="text/html; charset=utf-8" >
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/DeferredUntilInspirationHits" >
    <link rel="stylesheet" href="/stylesheets/yui-reset-fonts-grids.css" type="text/css" media="all">
    <link rel="stylesheet" href="/stylesheets/blog.css" type="text/css" media="all" charset="utf-8">
    <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" media="all" charset="utf-8">
    <link rel="stylesheet" href="/stylesheets/print.css" type="text/css" media="print" charset="utf-8">
    <link rel="openid.server" href="http://www.myopenid.com/server">
    <link rel="openid.delegate" href="http://chrisroos.myopenid.com/">
    <title>Posts published in April 2007 - deferred until inspiration hits</title>
  </head>
  
  <body>
    
    <div id="doc3" class="yui-t4">
      <div id="hd">
        <h1><a class="blogTitle" href="/">deferred until inspiration hits</a></h1>
      </div>
      <div id="bd">
        <div id="yui-main">
          <div class="yui-b">
            <div class="yui-g">

              
                <h2>
                  <a href="/articles/2007/04/30/a-fun-and-crappy-monday-morning-quiz">A fun (and crappy) Monday morning quiz</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Mon, 30 Apr 2007 09:08:00">
                    Mon, 30 Apr 2007 09:08:00
                  </span>
                </p>

                <div class="typocode"><pre><code class="typocode_ruby"><span class="ident">require</span> <span class="punct">'</span><span class="string">test/unit</span><span class="punct">'</span>

<span class="keyword">class </span><span class="class">CandidateTest</span> <span class="punct">&lt;</span> <span class="constant">Test</span><span class="punct">::</span><span class="constant">Unit</span><span class="punct">::</span><span class="constant">TestCase</span>
  <span class="keyword">def </span><span class="method">setup</span>
    <span class="attribute">@candidate</span> <span class="punct">=</span> <span class="constant">Candidate</span><span class="punct">.</span><span class="ident">new</span>
  <span class="keyword">end</span>
  <span class="keyword">def </span><span class="method">test_should_love_learning</span>
    <span class="ident">assert</span> <span class="attribute">@candidate</span><span class="punct">.</span><span class="ident">loves_learning?</span>
  <span class="keyword">end</span>
  <span class="keyword">def </span><span class="method">test_should_love_ruby</span>
    <span class="ident">assert</span> <span class="attribute">@candidate</span><span class="punct">.</span><span class="ident">loves_ruby?</span>
  <span class="keyword">end</span>
  <span class="keyword">def </span><span class="method">test_should_love_problem_solving</span>
    <span class="ident">assert</span> <span class="attribute">@candidate</span><span class="punct">.</span><span class="ident">loves_problem_solving?</span>
  <span class="keyword">end</span>
  <span class="keyword">def </span><span class="method">test_should_not_be_a_job_agency</span>
    <span class="ident">assert</span> <span class="punct">!</span><span class="attribute">@candidate</span><span class="punct">.</span><span class="ident">is_a_job_agency?</span>
  <span class="keyword">end</span>
  <span class="keyword">def </span><span class="method">test_should_know_the_secret_password</span>
    <span class="ident">secret_password</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">hmm, so you think you know the secret password huh?</span><span class="punct">'</span>
    <span class="ident">candidate</span> <span class="punct">=</span> <span class="constant">Candidate</span><span class="punct">.</span><span class="ident">new</span><span class="punct">(</span><span class="ident">secret_password</span><span class="punct">)</span>
    <span class="ident">i_know_it_so_please_show_me_the_money</span><span class="punct">(</span><span class="ident">candidate</span><span class="punct">)</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">__END__
Y2xhc3MgQ2FuZGlkYXRlCiAgZGVmIGluaXRpYWxpemUodG9wX3NlY3JldF9w
YXNzd29yZCA9IG5pbCkKICAgIEBzZWNyZXRfbWVzc2FnZSA9IG5pbAogICAg
aWYgdG9wX3NlY3JldF9wYXNzd29yZCA9PSAncnVieSBpcyBjb29sJwogICAg
ICBAc2VjcmV0X21lc3NhZ2UgPSAiQ2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9x
S2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9xCktpb3FLaW9x
S2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9xS2lvcUtpb3FL
aW9xQ2xkdgpiMmh2Ynl3Z2VXOTFJR1p2ZFc1a0lIUm9hWE1nZG1WeWVTQndi
Mjl5YkhrZ2FHbGtaR1Z1TENCdFpXZGgKTFhObFkzSmxkQ3dnYldWemMyRm5a
UzRLQ2trZ2MyRjVJRzFsWjJFdGMyVmpjbVYwTENCaWRYUWdkRzhnClltVWdh
Rzl1WlhOMExDQjBhR2x6SUdseklHcDFjM1FnWVNCMGFHbHViSGtnZG1WcGJH
VmtJR3B2WWlCaApaSFpsY25RZ1ptOXlDbkpsWlhadmJ5NWpiMjB1SUNCVGIz
SnllU3dnWW5WMElFa2dkMkZ6SUdKdmNtVmsKSUc5dUlIUm9aU0IwY21GcGJp
NHVMZ29LUVc1NWFHOXZMQ0JwWmlCNWIzVWdabUZ1WTNrZ2QyOXlhMmx1Clp5
QjNhWFJvSUhWeklIUm9aVzRnWTJobFkyc2dRbVZ1SjNNZ2NHOXpkRnN4WFNC
aGJtUWdZWEJ3YkhrcwpJR0Z3Y0d4NUxDQmhjSEJzZVM0S0Nsc3hYU0JvZEhS
d09pOHZkM2QzTG5KbFpYWnZieTVqYjIwdllteHYKWjNNdlltVnVaM0pwWm1a
cGRHaHpMekl3TURjdk1EUXZNRE12Y21GcGJITXRaR1YyWld4dmNHVnlMV3B2
CllpOEtLaW9xS2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9x
S2lvcUtpb3FLaW9xS2lvcQpLaW9xS2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9x
S2lvcUtpb3FLaW9xS2lvcUtpb3FLaW9xS2lvcUtpb0sKQ2c9PQoiCiAgICBl
bmQKICBlbmQKICBkZWYga25vd3NfdGhlX3NlY3JldF9wYXNzd29yZD8KICAg
IEBzZWNyZXRfbWVzc2FnZQogIGVuZAogIGRlZiBsb3Zlc19sZWFybmluZz8K
ICAgIHRydWUKICBlbmQKICBkZWYgbG92ZXNfcnVieT8KICAgIHRydWUKICBl
bmQKICBkZWYgbG92ZXNfcHJvYmxlbV9zb2x2aW5nPwogICAgdHJ1ZQogIGVu
ZAogIGRlZiBpc19hX2pvYl9hZ2VuY3k/CiAgICBmYWxzZQogIGVuZAogIGRl
ZiBzZWNyZXRfbWVzc2FnZQogICAgcmFpc2UgIlVoIG9oLCBsb29rcyBsaWtl
IHlvdSBoYXZlIG9uZSBvdGhlciBsaXR0bGUgbWV0aG9kIHRvIGltcGxlbWVu
dC4uLiIKICBlbmQKZW5kCgpjbGFzcyBUZXN0OjpVbml0OjpUZXN0Q2FzZQog
IGRlZiBpX2tub3dfaXRfc29fcGxlYXNlX3Nob3dfbWVfdGhlX21vbmV5KGNh
bmRpZGF0ZSkKICAgIHJhaXNlICJVaCBvaCwgdGhhdCdzIG5vdCB0aGUgcmln
aHQgcGFzc3dvcmQiIHVubGVzcyBjYW5kaWRhdGUua25vd3NfdGhlX3NlY3Jl
dF9wYXNzd29yZD8KICAgIHB1dHMgQ2FuZGlkYXRlLm5ldygncnVieSBpcyBj
b29sJykuc2VjcmV0X21lc3NhZ2UKICBlbmQKZW5kCg==</span></code></pre></div>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/job" rel="tag">job</a>, 
                    
                      <a href="/articles/tag/quiz" rel="tag">quiz</a>, 
                    
                      <a href="/articles/tag/reevoo" rel="tag">reevoo</a>, 
                    
                      <a href="/articles/tag/ruby" rel="tag">ruby</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/04/20/tonic-systems-tonicpoint-free-powerpoint-viewer">Tonic Systems TonicPoint free Powerpoint viewer</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Fri, 20 Apr 2007 09:01:00">
                    Fri, 20 Apr 2007 09:01:00
                  </span>
                </p>

                <p>I had need to view a powerpoint presentation on my Mac.  In the past, I&#8217;ve uploaded them to <a href="http://www.slideshare.net">slideshare</a>, but that wasn&#8217;t suitable in this instance.  A quick google reveals some free java software by tonic systems.  Unfortunately (well, fortunately for tonic systems), they&#8217;ve been <a href="http://www.tonicsystems.com/">bought</a> by google and the link to their software has disappeared.  Luckily, the google cache has a copy of the <a href="http://www.google.co.uk/search?q=cache:4BswR-sgicYJ:www.tonicsystems.com/products/viewer/+tonicsystems+java+viewer&#38;hl=en&#38;ct=clnk&#38;cd=1&#38;gl=uk">original page</a> with a <a href="http://downloads.tonicsystems.com/viewer/TonicPointViewer-1.4-OSX.zip">working link</a> to the download.</p>


	<p>This probably won&#8217;t remain relevant very long, what with the recent <a href="http://www.techcrunch.com/2007/04/17/googles-office-suite-complete-google-powerpoint-confirmed/">news</a> of google adding a powerpoint clone to their office suite.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/google" rel="tag">google</a>, 
                    
                      <a href="/articles/tag/office" rel="tag">office</a>, 
                    
                      <a href="/articles/tag/powerpoint" rel="tag">powerpoint</a>, 
                    
                      <a href="/articles/tag/software" rel="tag">software</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/04/14/ebay-feedback">ebay feedback</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Sat, 14 Apr 2007 08:47:00">
                    Sat, 14 Apr 2007 08:47:00
                  </span>
                </p>

                <p>This is a pathetic moan about something that is really not important at all.</p>


	<p>I bought an <a href="http://cgi.ebay.co.uk/ws/eBayISAPI.dll?ViewItem&#38;ih=014&#38;sspagename=STRK%3AMEWN%3AIT&#38;viewitem=&#38;item=330105019114&#38;rd=1&#38;rd=1">Apple mini <span class="caps">DVI</span> to <span class="caps">VGA</span> adapter</a> from someone on <a href="http://www.ebay.co.uk">ebay</a>.  For various reasons, I was unable to test the adapter until yesterday (Fri 13th Apr), two weeks after the purchase.  That didn&#8217;t stop the seller emailing me a week ago, suggesting that I leave feedback before they do.  That&#8217;s pathetic &#8211; feedback should be left for me based on the speed of my purchase alone, which was immediate.  What the seller is actually saying in that email is that if I decide to leave them bad feedback then they&#8217;ll probably do the same to me out of retaliation.  Grow up eh.</p>


	<p>The adapter actually works great, and I&#8217;ve now left the seller positive feedback.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/ebay" rel="tag">ebay</a>, 
                    
                      <a href="/articles/tag/feedback" rel="tag">feedback</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/04/14/small-specific-mongrel-web-servers">Small, specific mongrel web servers</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Sat, 14 Apr 2007 00:44:00">
                    Sat, 14 Apr 2007 00:44:00
                  </span>
                </p>

                <p>I&#8217;ve created a simple <a href="http://mongrel.rubyforge.org/">mongrel</a> server that allows you to upload text files for subsequent deletion and retrieval.  If it sounds pretty pointless, that&#8217;s because it is&#8230;currently.  I wonder though, if the basic premise couldn&#8217;t be used to create some text-transformation tools.  I&#8217;m thinking of really simple tools that might spell-check a text file, or convert text from <a href="http://www.textism.com/tools/textile/">textile</a> to html.  My end goal would be to have lots of super simple tools that I can chain together to use as a blogging platform, removing my current dependence on <a href="http://trac.typosphere.org/">typo</a>.</p>


	<p>I&#8217;ve made the <a href="http://chrisroos.googlecode.com/svn/trunk/text_file_server/server.rb">server</a> slightly more complex than it needs to be by imposing some artificial constraints (<a href="http://chrisroos.googlecode.com/svn/trunk/text_file_server/server-test.rb">examples</a>).  The basic premise is that you <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.5">post</a> a text file, between 1 and 5000 bytes in size, with a <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17">content-type</a> of <a href="http://www.iana.org/assignments/media-types/text/">plain/text</a>.  All being well, the server responds with <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.2">201 Created</a> and the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30">location</a> of the new resource.  The resource is actually retrieved by <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.7">deleting</a> it &#8211; the contents of the file are returned in the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.3">body</a> with a &#8220;200 OK&#8221; response.  I&#8217;ve tried to use the relevant <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4"><span class="caps">HTTP</span> error</a> when resource creation fails.  The whole &#8216;post&#8217; and &#8216;delete&#8217; pattern for these transformations feels kinda <a href="http://en.wikipedia.org/wiki/Representational_State_Transfer">restful</a>, but I may be way off the mark.</p>


	<p>I&#8217;m wondering how much of <a href="http://pipes.yahoo.com/pipes/">yahoo pipes</a> could be replicated with lots of small, specific web servers.</p>


	<p>Anyone have any thoughts on any of this?</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/http" rel="tag">http</a>, 
                    
                      <a href="/articles/tag/mongrel" rel="tag">mongrel</a>, 
                    
                      <a href="/articles/tag/rest" rel="tag">rest</a>, 
                    
                      <a href="/articles/tag/restful" rel="tag">restful</a>, 
                    
                      <a href="/articles/tag/ruby" rel="tag">ruby</a>, 
                    
                      <a href="/articles/tag/servers" rel="tag">servers</a>, 
                    
                      <a href="/articles/tag/web" rel="tag">web</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/04/11/getting-to-grips-with-pwdhash">Getting to grips with pwdhash</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Wed, 11 Apr 2007 22:27:00">
                    Wed, 11 Apr 2007 22:27:00
                  </span>
                </p>

                <h3>Overview</h3>


	<p>Having used <a href="http://www.pwdhash.com">pwdhash</a> for a while, I decided it was about time I dived into the implementation to see what was actually going on.  I figured that the best way for me to get an understanding of the library was to translate it from <a href="http://en.wikipedia.org/wiki/Javascript">javascript</a> to <a href="http://www.ruby-lang.org">ruby</a>.</p>


	<h3>Investigating the javascript libraries</h3>


	<p>The first step was to create a basic environment within which I could explore the existing javascript functionality.  Relying on <a href="http://www.getfirebug.com/">Firebug</a> to provide a javascript console, this was as simple as creating a very basic html page.</p>


<div class="typocode"><pre><code class="typocode_default">&lt;html&gt;
  &lt;head&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;md5.js&quot; /&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;hashed-password.js&quot; /&gt;
    &lt;title&gt;pwdhash client&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre></div>

	<p>It actually took me a good few minutes to get up and running with this environment.  It seems that <a href="http://crypto.stanford.edu/PwdHash/RemotePwdHash/hashed-password.js">hashed-password.js</a> relies on a variable, <span class="caps">SPH</span>_kPasswordPrefix, being defined.  Although defined in <a href="http://crypto.stanford.edu/PwdHash/RemotePwdHash/pwdhash.js">pwdhash.js</a>, it turns out to be our only dependency on that file.  In wanting to keep the environment as simple as possible, I chose to copy the definition of that variable to hashed-password.js, allowing us to remain independent of pwdhash.js.</p>


	<h3>Starting to implement the javascript functions in ruby</h3>


	<p>Knowing that <a href="http://pajhome.org.uk/crypt/md5/md5src.html">md5.js</a> implemented pretty standard <a href="http://en.wikipedia.org/wiki/Md5">md5</a> (<a href="http://www.faqs.org/rfcs/rfc1321.html">rfc</a>) and <a href="http://en.wikipedia.org/wiki/Hmac">hmac</a> (<a href="http://www.faqs.org/rfcs/rfc2104.html">rfc</a>) routines, for which there are equivalents in ruby, I chose to concentrate on translating hashed-password.js.  Although the code is pretty simple, it took me a while to understand because of my limited javascript knowledge.  We essentially construct an object (SPH_HashedPassword), supplying it with password and realm (domain), that generates, and represents, the hashed password.</p>


	<p>The very first thing that a newly created <span class="caps">SPH</span>_HashedPassword does, is to use the b64_hmac_md5 function, supplied in the md5.js library, to generate the initial hash.  I really didn&#8217;t expect to be tripped up quite this early on, but I just couldn&#8217;t replicate the value obtained from b64_hmac_md5 (using <a href="http://ruby-doc.org/stdlib/libdoc/digest/rdoc/index.html">digest/md5</a> and <a href="http://deisui.org/~ueno/ruby/hmac.html">ruby-hmac</a>.)  I now realise that I didn&#8217;t fully understand what I was actually trying to replicate &#8211; I really should have paid more attention to those three little letters (b64 / <a href="http://www.faqs.org/rfcs/rfc3548.html">base64</a>) at the beginning of the function name&#8230;</p>


	<h3>Back to the drawing-board &#8211; starting to implement the md5.js library in ruby</h3>


	<p>Without thinking about it as much as I should have, I decided that maybe I needed to implement the functionality provided in md5.js in ruby (<a href="http://chrisroos.googlecode.com/svn/trunk/pwdhash-rb/md5-rb/md5.rb">code</a> for reference).  I dived in and started replicating one function at a time.  All was going OK until I came across the <a href="http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Guide:Operators:Bitwise_Operators#Bitwise_Shift_Operators">zero fill right shift</a> bitwise operator in javascript.  There is no standard equivalent in ruby, but a little help from the <a href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/144877">mailing list</a> allowed me to come up with this implementation.</p>


<div class="typocode"><pre><code class="typocode_default">class Integer
  def zero_fill_right_shift(count)
    (self &gt;&gt; count) &amp; ((2 ** (size_in_bits-count))-1) # defined in Integer, size_in_bits is self.size * 8
  end
end</code></pre></div>

	<p>Although this allowed me to move a little further, progress completely ground to a halt when trying to replicate the bit_rol function.  It seems that bitwise left-shifting by a negative number offers a different result in javascript and ruby.</p>


<div class="typocode"><pre><code class="typocode_default">javascript: 1 &lt;&lt; -1 = -2147483648
ruby: 1 &lt;&lt; -1 = 0</code></pre></div>

	<h3>Back to the drawing-board (again) &#8211; using digest/md5 and ruby-hmac to replicate the results given by md5.js</h3>


	<p>This time, I decided to break the b64_hmac_md5 function down into its component parts and see which, if any, differed between ruby and javascript.  The first step was to compare the hex output of a simple md5 of a string.</p>


<div class="typocode"><pre><code class="typocode_default">javascript: hex_md5(text) =&gt; &quot;1cb251ec0d568de6a929b520c4aed8d1&quot;
ruby: Digest::MD5.new(text).hexdigest =&gt; 1cb251ec0d568de6a929b520c4aed8d1</code></pre></div>

	<p>Next up was a comparison of an <span class="caps">HMAC MD5</span> of a key and some data.</p>


<div class="typocode"><pre><code class="typocode_default">javascript: hex_hmac_md5(key, data) =&gt; &quot;9d5c73ef85594d34ec4438b7c97e51d8&quot;
ruby: HMAC::MD5.hexdigest(key, data) =&gt; &quot;9d5c73ef85594d34ec4438b7c97e51d8&quot;</code></pre></div>

	<p>Although we can easily replicate the result of hex_hmac_md5 in ruby, we actually want to replicate the result of b64_hmac_md5 (i.e. the hashed data encoded in base64 representation.)
With a bit of thinking, and some trial and error, I realised that I needed to calculate the binary digest of the key and data, and then base64 encode the result.  <strong>Note</strong>.  My original problems arose when comparing the output of the binary string data, what with Javascript being able to display unicode characters and ruby just displaying their code points in octal representation.</p>


<div class="typocode"><pre><code class="typocode_default">javascript: b64_hmac_md5(key, data) =&gt; &quot;nVxz74VZTTTsRDi3yX5R2A&quot;
ruby: # This requires both ruby-hmac and base64
ruby: Base64.encode64(HMAC::MD5.digest(key, data)) =&gt; &quot;nVxz74VZTTTsRDi3yX5R2A==&quot;</code></pre></div>

	<p>This is the first time we see any difference in the values obtained from javascript and ruby.  It turns out that there&#8217;s a clue to this difference in the md5.js library:</p>


<div class="typocode"><pre><code class="typocode_default">var b64pad  = &quot;&quot;; /* base-64 pad character. &quot;=&quot; for strict RFC compliance   */</code></pre></div>

	<p>Ok, so it seems I should just be able to remove the pad characters (=) from my generated hash and I&#8217;ll achieve the same value.  Happy that this was a pretty easy difference to resolve, I could move forward with actually implementing the pwdhash magic in ruby&#8230;</p>


	<h3>Implementing the pwdhash magic in ruby</h3>


	<p>The pwdhash specific stuff is actually very simple.  It alters the initial base 64 encoded hash to ensure that we have:</p>


	<ul>
	<li>One upper case char</li>
		<li>One lower case char</li>
		<li>One non alpha-numeric char</li>
		<li>One number</li>
	</ul>


	<p>So, having got over the first hurdle, the remainder of the translation was pretty simple.  In fact, in its current <a href="http://chrisroos.googlecode.com/svn/trunk/pwdhash-rb/pwdhash.rb">incarnation</a> (revision 62), there are only a few small syntactical differences between the javascript and ruby versions.</p>


	<h3>Next steps</h3>


	<p>Rubify the code.  Although I&#8217;ve copied it almost directly from the javascript I think I&#8217;ve actually managed to make it slightly less readable.</p>


	<p>Investigate the whole world of <a href="http://www.unicode.org">unicode</a> a bit more &#8211; I definitely don&#8217;t know as much about it as I should.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/hashing" rel="tag">hashing</a>, 
                    
                      <a href="/articles/tag/hmac" rel="tag">hmac</a>, 
                    
                      <a href="/articles/tag/javascript" rel="tag">javascript</a>, 
                    
                      <a href="/articles/tag/md5" rel="tag">md5</a>, 
                    
                      <a href="/articles/tag/pwdhash" rel="tag">pwdhash</a>, 
                    
                      <a href="/articles/tag/ruby" rel="tag">ruby</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/04/04/i-want-fast-trains">I want fast trains</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Wed, 04 Apr 2007 20:19:00">
                    Wed, 04 Apr 2007 20:19:00
                  </span>
                </p>

                <p><strong>Update Tue Apr 10th</strong> Maybe <a href="http://maps.google.com/help/maps/userguide/index.html">google</a> read my question.</p>


	<p>The <a href="http://news.bbc.co.uk/1/hi/world/europe/6521295.stm">news</a> of the very, very, very fast train in France made me wonder how one of my <a href="http://www.wayfaring.com/maps/show/35440">regular routes</a> compared.</p>


<iframe src="http://www.wayfaring.com/maps/export/35440" scrolling="no" frameborder="0" style="width:400px;height:250px;border:2px solid #cccccc;"></iframe>

	<p>At the time I travel, the journey takes 2 hours 10 minutes.  So, 130 minutes to travel 84 miles.  That&#8217;ll be about 38 miles an hour then.  Brilliant.</p>


	<p>Actually, does anyone know of any sites (like wayfaring) where I might plot some points on a map and get either a <a href="http://www.georss.org/">georss</a> or <a href="http://earth.google.com/kml/">kml</a> feed of the data?  I like <a href="http://www.wayfaring.com">wayfaring</a> an&#8217; all, but it&#8217;d be nice to be able to separate the route data from their site.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/commute" rel="tag">commute</a>, 
                    
                      <a href="/articles/tag/train" rel="tag">train</a>, 
                    
                      <a href="/articles/tag/travel" rel="tag">travel</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/04/03/obtaining-latitude-longitude-for-uk-postcodes">Obtaining latitude/longitude for UK postcodes</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Tue, 03 Apr 2007 21:33:00">
                    Tue, 03 Apr 2007 21:33:00
                  </span>
                </p>

                <p>It turns out that we can use <a href="http://streetmap.co.uk">streetmap.co.uk</a> to <a href="http://streetmap.co.uk/streetmap.dll?GridConvert">convert</a> a UK postcode to latitude/longitude.  It also turns out that a combination of <a href="http://curl.haxx.se/">curl</a>, <a href="http://www.ruby-lang.org">ruby</a> and <a href="http://code.whytheluckystiff.net/hpricot/">hpricot</a> make it very easy to bypass the streetmap site to perform the conversion.</p>


<div class="typocode"><pre><code class="typocode_ruby"><span class="ident">postcode</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">SW1A 2AJ</span><span class="punct">'</span>

<span class="ident">html</span> <span class="punct">=</span> `<span class="ident">curl</span> <span class="punct">&quot;</span><span class="string">http://streetmap.co.uk/streetmap.dll</span><span class="punct">&quot;</span> <span class="punct">-</span><span class="ident">d</span><span class="punct">&quot;</span><span class="string">MfcISAPICommand=GridConvert</span><span class="punct">&quot;</span> <span class="punct">-</span><span class="ident">d</span><span class="punct">&quot;</span><span class="string">name=<span class="expr">#{postcode}</span></span><span class="punct">&quot;</span> <span class="punct">-</span><span class="ident">d</span><span class="punct">&quot;</span><span class="string">type=PostCode</span><span class="punct">&quot;`</span>

<span class="ident">require</span> <span class="punct">'</span><span class="string">rubygems</span><span class="punct">'</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">hpricot</span><span class="punct">'</span>

<span class="ident">doc</span> <span class="punct">=</span> <span class="constant">Hpricot</span><span class="punct">(</span><span class="ident">html</span><span class="punct">)</span>

<span class="ident">latitude</span><span class="punct">,</span> <span class="ident">longitude</span> <span class="punct">=</span> <span class="number">0</span><span class="punct">,</span> <span class="number">0</span>

<span class="punct">(</span><span class="ident">doc</span><span class="punct">/&quot;</span><span class="string">div</span><span class="punct">&quot;/&quot;</span><span class="string">center</span><span class="punct">&quot;/&quot;</span><span class="string">table</span><span class="punct">&quot;/&quot;</span><span class="string">tr</span><span class="punct">&quot;).</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">row</span><span class="punct">|</span>
  <span class="ident">attribute</span> <span class="punct">=</span> <span class="punct">(</span><span class="ident">row</span><span class="punct">/&quot;</span><span class="string">td</span><span class="punct">&quot;).</span><span class="ident">first</span><span class="punct">.</span><span class="ident">inner_text</span>
  <span class="ident">value</span> <span class="punct">=</span> <span class="punct">(</span><span class="ident">row</span><span class="punct">/&quot;</span><span class="string">td</span><span class="punct">&quot;).</span><span class="ident">last</span><span class="punct">.</span><span class="ident">inner_text</span>
  <span class="keyword">if</span> <span class="ident">attribute</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex">lat</span><span class="punct">/</span><span class="ident">i</span>
    <span class="ident">latitude</span> <span class="punct">=</span> <span class="constant">Float</span><span class="punct">(</span><span class="ident">value</span><span class="punct">[/</span><span class="regex"><span class="escape">\(</span>(.*)<span class="escape">\)</span></span><span class="punct">/,</span> <span class="number">1</span><span class="punct">])</span>
  <span class="keyword">elsif</span> <span class="ident">attribute</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex">long</span><span class="punct">/</span><span class="ident">i</span>
    <span class="ident">longitude</span> <span class="punct">=</span> <span class="constant">Float</span><span class="punct">(</span><span class="ident">value</span><span class="punct">[/</span><span class="regex"><span class="escape">\(</span>(.*)<span class="escape">\)</span></span><span class="punct">/,</span> <span class="number">1</span><span class="punct">])</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="ident">p</span> <span class="punct">[</span><span class="ident">latitude</span><span class="punct">,</span> <span class="ident">longitude</span><span class="punct">]</span></code></pre></div>

	<p>Err, this is probably a bit naughty.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/cool" rel="tag">cool</a>, 
                    
                      <a href="/articles/tag/naughty" rel="tag">naughty</a>, 
                    
                      <a href="/articles/tag/ruby" rel="tag">ruby</a>, 
                    
                      <a href="/articles/tag/streetmap" rel="tag">streetmap</a>, 
                    
                  </p>
                
              
                <h2>
                  <a href="/articles/2007/04/01/converting-egg-credit-card-statements-to-ofx-for-upload-to-wesabe">Converting Egg Credit Card Statements to Ofx (for upload to wesabe)</a>
                </h2>
                <p class="postedOn">
                  Posted by Chris Roos
                  <span class="typo_date" title="Sun, 01 Apr 2007 13:48:00">
                    Sun, 01 Apr 2007 13:48:00
                  </span>
                </p>

                <p>I&#8217;ve cobbled together some pretty nasty code to convert an <a href="http://www.egg.com">Egg</a> Credit Card statement to <a href="http://www.ofx.net">Ofx</a>.</p>


	<p>Grab the <a href="http://chrisroos.googlecode.com/svn/trunk/egg-ofx/">source</a> from <a href="http://code.google.com">google code</a>.</p>


<div class="typocode"><pre><code class="typocode_default">svn checkout http://chrisroos.googlecode.com/svn/trunk/egg-ofx</code></pre></div>

	<p>As well as requiring <a href="http://code.whytheluckystiff.net/hpricot/">hpricot</a>, you will need to edit the StatementsFolder and OfxOutputFolder variables in egg.rb.  These need to point to a directory containing html statements, and an empty output directory respectively.</p>


	<p>I&#8217;ve used the script to upload my last 12 statements to <a href="http://www.wesabe.com">wesabe</a> and everything seems to work Ok. If you have any questions, just post a comment here.</p>

                
                  <p>
                    Tags 
                    
                      <a href="/articles/tag/egg.com" rel="tag">egg.com</a>, 
                    
                      <a href="/articles/tag/finance" rel="tag">finance</a>, 
                    
                      <a href="/articles/tag/ofx" rel="tag">ofx</a>, 
                    
                      <a href="/articles/tag/wesabe" rel="tag">wesabe</a>, 
                    
                  </p>
                
              

            </div>
          </div>
        </div>
        <div class="yui-b">
          <img class="avatar" src="/images/me.jpg" width="170px" height="111px" alt="Me">
          
          <ul class="navigation">
            <li>
              <a href="/contents">contents</a>
            </li>
            <li>
              <a href="http://flickr.com/photos/chrisjroos">flickr</a>
            </li>
          </ul>
          
          <div id="twitter_div">
            <h3><a href="http://twitter.com/chrisroos">twitter</a></h3>
            <ul id="twitter_update_list"></ul>
          </div>
          
          <div id="deliciousContainer">
            <h3><a href="http://del.icio.us/chrisjroos">del.icio.us</a></h3>
          </div>
        </div>
      </div>
    </div>
    <div id="ft">
      <!-- Footer -->
    </div>
    
    <script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script>
    <script type="text/javascript" src="http://twitter.com/statuses/user_timeline/chrisroos.json?callback=twitterCallback2&amp;count=5"></script>
    
    <script type="text/javascript" src="http://del.icio.us/feeds/json/chrisjroos?count=5"></script>
    <script type="text/javascript" src="/javascripts/delicious.js"></script>
  
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      if (typeof(_gat) != 'undefined') {
        var pageTracker = _gat._getTracker("UA-160238-1");
        pageTracker._initData();
        pageTracker._trackPageview();
      }
    </script>
  </body>

</html>

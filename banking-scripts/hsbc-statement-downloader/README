I think this is a rewrite of another hsbc download script I had.  I seem to recall getting it so far and then realising that the objects I'd created weren't actually good enough for what I needed!